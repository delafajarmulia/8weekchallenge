-- create database
CREATE DATABASE data_mart;

-- create table weekly_sales
CREATE TABLE data_mart.weekly_sales (
  id int PRIMARY KEY AUTO_INCREMENT,
  week_date VARCHAR(7),
  region VARCHAR(13),
  platform VARCHAR(7),
  segment VARCHAR(4),
  customer_type VARCHAR(8),
  transactions int,
  sales int
);

-- insert into weekly_sales table
INSERT INTO weekly_sales
  (week_date, region, platform, segment, customer_type, transactions, sales)
VALUES
  ('20/8/31', 'ASIA', 'Retail', 'C3', 'New', '120631', '3656163'),
  ('20/8/31', 'OCEANIA', 'Shopify', 'F3', 'New', '190', '30264'),
  ('20/8/31', 'USA', 'Retail', 'null', 'Guest', '529151', '16509610'),
  ('20/8/31', 'EUROPE', 'Retail', 'C1', 'New', '4517', '141942'),
  ('20/8/31', 'AFRICA', 'Retail', 'C2', 'New', '58046', '1758388'),
  ('20/8/31', 'OCEANIA', 'Shopify', 'F1', 'Existing', '4498', '839437'),
  ('20/8/31', 'CANADA', 'Shopify', 'F1', 'Existing', '789', '134990'),
  ('20/8/31', 'SOUTH AMERICA', 'Shopify', 'C3', 'Existing', '109', '23057'),
  ('20/8/24', 'CANADA', 'Shopify', 'C1', 'New', '80', '10467'),
  ('20/8/24', 'SOUTH AMERICA', 'Shopify', 'C2', 'Existing', '124', '25194'),
  ('20/8/24', 'USA', 'Retail', 'C3', 'New', '47022', '1797843'),
  ('20/8/24', 'SOUTH AMERICA', 'Retail', 'C3', 'New', '952', '38345'),
  ('20/8/24', 'ASIA', 'Retail', 'C1', 'Existing', '188753', '6315069'),
  ('20/8/24', 'EUROPE', 'Retail', 'null', 'New', '2962', '129020'),
  ('20/8/24', 'AFRICA', 'Retail', 'C2', 'New', '58705', '1860988'),
  ('20/8/24', 'AFRICA', 'Shopify', 'F3', 'Existing', '2331', '486331'),
  ('20/8/24', 'ASIA', 'Shopify', 'F1', 'New', '208', '28542'),
  ('20/8/24', 'SOUTH AMERICA', 'Shopify', 'C3', 'Existing', '91', '18712'),
  ('20/8/17', 'OCEANIA', 'Shopify', 'C2', 'Existing', '4440', '835663'),
  ('20/8/17', 'USA', 'Shopify', 'F1', 'Existing', '1318', '244502'),
  ('20/8/17', 'AFRICA', 'Shopify', 'F3', 'Existing', '2391', '486614'),
  ('20/8/17', 'OCEANIA', 'Shopify', 'C4', 'New', '100', '13673'),
  ('20/8/17', 'EUROPE', 'Shopify', 'C2', 'Existing', '160', '50681'),
  ('20/8/17', 'OCEANIA', 'Shopify', 'F1', 'Existing', '4324', '800804'),
  ('20/8/17', 'EUROPE', 'Shopify', 'F2', 'New', '8', '1412'),
  ('20/8/17', 'SOUTH AMERICA', 'Shopify', 'null', 'New', '47', '8678'),
  ('20/8/17', 'SOUTH AMERICA', 'Retail', 'C4', 'New', '257', '9779'),
  ('20/8/17', 'USA', 'Shopify', 'F2', 'New', '146', '22610'),
  ('20/8/10', 'AFRICA', 'Retail', 'null', 'Guest', '1552707', '44304726'),
  ('20/8/10', 'USA', 'Shopify', 'F2', 'Existing', '1913', '384475'),
  ('20/8/10', 'USA', 'Retail', 'null', 'New', '23420', '971003'),
  ('20/8/10', 'AFRICA', 'Shopify', 'null', 'Existing', '382', '71027'),
  ('20/8/10', 'OCEANIA', 'Shopify', 'C2', 'New', '770', '125489'),
  ('20/8/10', 'SOUTH AMERICA', 'Shopify', 'null', 'Guest', '2062', '393008'),
  ('20/8/10', 'OCEANIA', 'Shopify', 'C2', 'Existing', '4391', '817285'),
  ('20/8/10', 'USA', 'Shopify', 'F1', 'Existing', '1335', '253770'),
  ('20/8/3', 'EUROPE', 'Shopify', 'null', 'Guest', '371', '82928'),
  ('20/8/3', 'USA', 'Retail', 'F2', 'New', '26359', '947836'),
  ('20/8/3', 'USA', 'Retail', 'F2', 'Existing', '92243', '5223071'),
  ('20/8/3', 'EUROPE', 'Retail', 'C1', 'Existing', '14456', '642677'),
  ('20/8/3', 'ASIA', 'Shopify', 'C4', 'New', '38', '5552'),
  ('20/8/3', 'EUROPE', 'Shopify', 'F2', 'Existing', '224', '49924'),
  ('20/8/3', 'USA', 'Shopify', 'F3', 'New', '44', '6674'),
  ('20/7/20', 'SOUTH AMERICA', 'Shopify', 'C3', 'Existing', '98', '19477'),
  ('20/7/20', 'CANADA', 'Shopify', 'null', 'Existing', '83', '13028'),
  ('20/7/20', 'SOUTH AMERICA', 'Retail', 'null', 'Existing', '157', '6046'),
  ('20/7/20', 'SOUTH AMERICA', 'Shopify', 'C1', 'Existing', '69', '11678'),
  ('20/7/20', 'AFRICA', 'Shopify', 'C2', 'New', '401', '54568'),
  ('19/7/29', 'AFRICA', 'Retail', 'C4', 'Existing', '110233', '5664273'),
  ('19/7/29', 'EUROPE', 'Retail', 'F1', 'Existing', '6299', '392713'),
  ('19/7/29', 'EUROPE', 'Retail', 'C4', 'Existing', '4763', '265148'),
  ('19/7/29', 'EUROPE', 'Shopify', 'null', 'Existing', '13', '3016'),
  ('19/7/29', 'ASIA', 'Shopify', 'C1', 'New', '264', '31827'),
  ('19/7/29', 'ASIA', 'Shopify', 'F1', 'Existing', '1657', '284731'),
  ('19/7/29', 'ASIA', 'Retail', 'C3', 'New', '108292', '3394521'),
  ('19/7/29', 'CANADA', 'Shopify', 'null', 'Guest', '1040', '171564'),
  ('19/7/29', 'CANADA', 'Retail', 'null', 'Guest', '422024', '11759218'),
  ('19/7/29', 'SOUTH AMERICA', 'Retail', 'C2', 'Existing', '801', '29430'),
  ('19/7/29', 'SOUTH AMERICA', 'Shopify', 'C4', 'New', '2', '229'),
  ('19/7/29', 'ASIA', 'Retail', 'C3', 'Existing', '216731', '9993226'),
  ('19/7/29', 'AFRICA', 'Retail', 'C1', 'Existing', '167965', '6456437'),
  ('18/8/20', 'AFRICA', 'Shopify', 'C2', 'New', '205', '32186'),
  ('18/8/20', 'ASIA', 'Shopify', 'F3', 'New', '73', '11582'),
  ('18/8/20', 'OCEANIA', 'Retail', 'F1', 'New', '39791', '1412520'),
  ('18/8/20', 'USA', 'Retail', 'C4', 'Existing', '29773', '1683008'),
  ('18/8/20', 'AFRICA', 'Retail', 'F1', 'Existing', '86232', '4909403'),
  ('18/8/20', 'ASIA', 'Retail', 'F2', 'New', '66723', '2193709'),
  ('18/8/20', 'SOUTH AMERICA', 'Retail', 'F3', 'New', '312', '12013'),
  ('18/8/20', 'ASIA', 'Retail', 'C2', 'New', '71287', '1950082'),
  ('18/8/20', 'SOUTH AMERICA', 'Retail', 'null', 'Existing', '356', '14251'),
  ('18/8/20', 'EUROPE', 'Retail', 'C1', 'Existing', '14250', '682656');



-- real data from 8 week challenge
-- INSERT INTO weekly_sales
--   (week_date, region, platform, segment, customer_type, transactions, sales)
-- VALUES
--   ('31/8/20', 'ASIA', 'Retail', 'C3', 'New', '120631', '3656163'),
--   ('31/8/20', 'OCEANIA', 'Shopify', 'F3', 'New', '190', '30264'),
--   ('31/8/20', 'USA', 'Retail', 'null', 'Guest', '529151', '16509610'),
--   ('31/8/20', 'EUROPE', 'Retail', 'C1', 'New', '4517', '141942'),
--   ('31/8/20', 'AFRICA', 'Retail', 'C2', 'New', '58046', '1758388'),
--   ('31/8/20', 'OCEANIA', 'Shopify', 'F1', 'Existing', '4498', '839437'),
--   ('31/8/20', 'CANADA', 'Shopify', 'F1', 'Existing', '789', '134990'),
--   ('31/8/20', 'SOUTH AMERICA', 'Shopify', 'C3', 'Existing', '109', '23057'),
--   ('24/8/20', 'CANADA', 'Shopify', 'C1', 'New', '80', '10467'),
--   ('24/8/20', 'SOUTH AMERICA', 'Shopify', 'C2', 'Existing', '124', '25194'),
--   ('24/8/20', 'USA', 'Retail', 'C3', 'New', '47022', '1797843'),
--   ('24/8/20', 'SOUTH AMERICA', 'Retail', 'C3', 'New', '952', '38345'),
--   ('24/8/20', 'ASIA', 'Retail', 'C1', 'Existing', '188753', '6315069'),
--   ('24/8/20', 'EUROPE', 'Retail', 'null', 'New', '2962', '129020'),
--   ('24/8/20', 'AFRICA', 'Retail', 'C2', 'New', '58705', '1860988'),
--   ('24/8/20', 'AFRICA', 'Shopify', 'F3', 'Existing', '2331', '486331'),
--   ('24/8/20', 'ASIA', 'Shopify', 'F1', 'New', '208', '28542'),
--   ('24/8/20', 'SOUTH AMERICA', 'Shopify', 'C3', 'Existing', '91', '18712'),
--   ('17/8/20', 'OCEANIA', 'Shopify', 'C2', 'Existing', '4440', '835663'),
--   ('17/8/20', 'USA', 'Shopify', 'F1', 'Existing', '1318', '244502'),
--   ('17/8/20', 'AFRICA', 'Shopify', 'F3', 'Existing', '2391', '486614'),
--   ('17/8/20', 'OCEANIA', 'Shopify', 'C4', 'New', '100', '13673'),
--   ('17/8/20', 'EUROPE', 'Shopify', 'C2', 'Existing', '160', '50681'),
--   ('17/8/20', 'OCEANIA', 'Shopify', 'F1', 'Existing', '4324', '800804'),
--   ('17/8/20', 'EUROPE', 'Shopify', 'F2', 'New', '8', '1412'),
--   ('17/8/20', 'SOUTH AMERICA', 'Shopify', 'null', 'New', '47', '8678'),
--   ('17/8/20', 'SOUTH AMERICA', 'Retail', 'C4', 'New', '257', '9779'),
--   ('17/8/20', 'USA', 'Shopify', 'F2', 'New', '146', '22610'),
--   ('10/8/20', 'AFRICA', 'Retail', 'null', 'Guest', '1552707', '44304726'),
--   ('10/8/20', 'USA', 'Shopify', 'F2', 'Existing', '1913', '384475'),
--   ('10/8/20', 'USA', 'Retail', 'null', 'New', '23420', '971003'),
--   ('10/8/20', 'AFRICA', 'Shopify', 'null', 'Existing', '382', '71027'),
--   ('10/8/20', 'OCEANIA', 'Shopify', 'C2', 'New', '770', '125489'),
--   ('10/8/20', 'SOUTH AMERICA', 'Shopify', 'null', 'Guest', '2062', '393008'),
--   ('10/8/20', 'OCEANIA', 'Shopify', 'C2', 'Existing', '4391', '817285'),
--   ('10/8/20', 'USA', 'Shopify', 'F1', 'Existing', '1335', '253770'),
--   ('3/8/20', 'EUROPE', 'Shopify', 'null', 'Guest', '371', '82928'),
--   ('3/8/20', 'USA', 'Retail', 'F2', 'New', '26359', '947836'),
--   ('3/8/20', 'USA', 'Retail', 'F2', 'Existing', '92243', '5223071'),
--   ('3/8/20', 'EUROPE', 'Retail', 'C1', 'Existing', '14456', '642677'),
--   ('3/8/20', 'ASIA', 'Shopify', 'C4', 'New', '38', '5552'),
--   ('3/8/20', 'EUROPE', 'Shopify', 'F2', 'Existing', '224', '49924'),
--   ('3/8/20', 'USA', 'Shopify', 'F3', 'New', '44', '6674'),
--   ('20/7/20', 'SOUTH AMERICA', 'Shopify', 'C3', 'Existing', '98', '19477'),
--   ('20/7/20', 'CANADA', 'Shopify', 'null', 'Existing', '83', '13028'),
--   ('20/7/20', 'SOUTH AMERICA', 'Retail', 'null', 'Existing', '157', '6046'),
--   ('20/7/20', 'SOUTH AMERICA', 'Shopify', 'C1', 'Existing', '69', '11678'),
--   ('20/7/20', 'AFRICA', 'Shopify', 'C2', 'New', '401', '54568'),
--   ('29/7/19', 'AFRICA', 'Retail', 'C4', 'Existing', '110233', '5664273'),
--   ('29/7/19', 'EUROPE', 'Retail', 'F1', 'Existing', '6299', '392713'),
--   ('29/7/19', 'EUROPE', 'Retail', 'C4', 'Existing', '4763', '265148'),
--   ('29/7/19', 'EUROPE', 'Shopify', 'null', 'Existing', '13', '3016'),
--   ('29/7/19', 'ASIA', 'Shopify', 'C1', 'New', '264', '31827'),
--   ('29/7/19', 'ASIA', 'Shopify', 'F1', 'Existing', '1657', '284731'),
--   ('29/7/19', 'ASIA', 'Retail', 'C3', 'New', '108292', '3394521'),
--   ('29/7/19', 'CANADA', 'Shopify', 'null', 'Guest', '1040', '171564'),
--   ('29/7/19', 'CANADA', 'Retail', 'null', 'Guest', '422024', '11759218'),
--   ('29/7/19', 'SOUTH AMERICA', 'Retail', 'C2', 'Existing', '801', '29430'),
--   ('29/7/19', 'SOUTH AMERICA', 'Shopify', 'C4', 'New', '2', '229'),
--   ('29/7/19', 'ASIA', 'Retail', 'C3', 'Existing', '216731', '9993226'),
--   ('29/7/19', 'AFRICA', 'Retail', 'C1', 'Existing', '167965', '6456437'),
--   ('20/8/18', 'AFRICA', 'Shopify', 'C2', 'New', '205', '32186'),
--   ('20/8/18', 'ASIA', 'Shopify', 'F3', 'New', '73', '11582'),
--   ('20/8/18', 'OCEANIA', 'Retail', 'F1', 'New', '39791', '1412520'),
--   ('20/8/18', 'USA', 'Retail', 'C4', 'Existing', '29773', '1683008'),
--   ('20/8/18', 'AFRICA', 'Retail', 'F1', 'Existing', '86232', '4909403'),
--   ('20/8/18', 'ASIA', 'Retail', 'F2', 'New', '66723', '2193709'),
--   ('20/8/18', 'SOUTH AMERICA', 'Retail', 'F3', 'New', '312', '12013'),
--   ('20/8/18', 'ASIA', 'Retail', 'C2', 'New', '71287', '1950082'),
--   ('20/8/18', 'SOUTH AMERICA', 'Retail', 'null', 'Existing', '356', '14251'),
--   ('20/8/18', 'EUROPE', 'Retail', 'C1', 'Existing', '14250', '682656');